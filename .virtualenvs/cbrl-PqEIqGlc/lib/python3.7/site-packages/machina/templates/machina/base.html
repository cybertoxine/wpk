{% load static %}
{% load inbox %}
<head>
<title>
Wiadomo≈õci prywatne.
</title>
<style>

@font-face {
  font-family: 'inter';
  src: url('{% static 'inter.ttf' %}') format('truetype');
}

.skrz {
padding-top: 5vh;
padding-bottom: 5vh;
margin:5 0 5 0;
width: calc(100% - 20px);
font-family: 'inter', Arial, sans-serif;
font-size:1.7vw;
border:none;
opacity:1;
background-color:gray;
color:white;
cursor:pointer;
}

.skrzp {
padding-top: 2vh;
padding-bottom: 2vh;
margin:5 0 5 0;
width: 100%;
font-family: 'inter', Arial, sans-serif;
font-size:4vw;
border:none;
opacity:1;
background-color:gray;
color:white;
cursor:pointer;
}

.skrz:hover {
background-color: #a0ada0;
}

.messages {
width:100%;
border-collapse: collapse;
font-size:1rem;

table-layout: fixed;
overflow-wrap: break-word;
word-wrap: break-word; /* IE */

}

.messages td {
padding:0.5em;
}
.messagesp {
width:100%;
border-collapse: collapse;
font-size:4vw;

table-layout: fixed;
overflow-wrap: break-word;
word-wrap: break-word; /* IE */

}




.messagesp td {
text-align:left;
width:21%;
}

.messagesp tr:nth-child(even) {
background: #f3f3f3;

}



.messagesp tr:nth-child(odd) {
background: #FFF;

}

.messagesp th {
background: #000;
color:white;
}


















.messages td {
text-align:left;
width:21%;
}

.messages tr:nth-child(even) {
background: #f3f3f3;

}



.messages tr:nth-child(odd) {
background: #FFF;

}

.messages th {
background: #000;
color:white;
}






.message-headers dt {
color:crimson;
}

.mesydz {
padding:10px;
border: 1px solid crimson;
background-color:white;
}

body {
margin:0px;
background-color:rgba(0,128,128,0.5);
font-family: 'inter', Arial, sans-serif;
}

.butony {
background-color:#008080;
top:0px;
left:0px;
position:fixed;
width:16%;
height:100vh;
}

.butonyp {
background-color:#008080;
width:100%;
margin-bottom:6vh;
}

.div0 {
margin-left:calc(16% + 20px);
margin-right:20px;
margin-top:10px;
}

.div0p {
margin-left:0px;
margin-right:0px;
margin-top:10px;
}














</style>
</head>

{% block sidebar %}
{% endblock sidebar %}
<div id="div0" class="div0">
{% block content %}
{% endblock content %}
</div>


<script>
polozeniePanelu();

window.addEventListener("resize", polozeniePanelu);

function polozeniePanelu() {
if (window.innerWidth/window.innerHeight < 1) {
document.getElementById("butony").className = "butonyp";
document.getElementById("div0").className = "div0p";
document.getElementById("b0").className = "skrzp";
document.getElementById("b1").className = "skrzp";
document.getElementById("b2").className = "skrzp";
document.getElementById("b3").className = "skrzp";

if (document.getElementById("napiszbutt")){
document.getElementById("id_body").style.fontSize = "4vw";
document.getElementById("id_subject").style.fontSize = "4vw";
document.getElementById("id_recipient").style.fontSize = "4vw";
document.getElementById("napisz").style.fontSize = "4vw";
document.getElementById("napiszbutt").style.fontSize = "4vw";
}

if (document.getElementById("tab")){
    document.getElementById("tab").className = "messagesp";


    var ostatnie = document.querySelectorAll("#last_td");
    ostatnie.forEach(function(kolumna) {
    kolumna.style.width= "16%";
    kolumna.style.textAlign = "center";
});
}
//-------------
if (document.getElementById("m_info")){
document.getElementById("m_info").style.fontSize = "4vw";
document.getElementById("mesydz").style.fontSize = "4vw";
}

if (document.getElementById("o_u")){
document.getElementById("o_u").style.fontSize = "4vw";
}

//------------

}else {
document.getElementById("butony").className = "butony";
document.getElementById("div0").className = "div0";
document.getElementById("b0").className = "skrz";
document.getElementById("b1").className = "skrz";
document.getElementById("b2").className = "skrz";
document.getElementById("b3").className = "skrz";
if (document.getElementById("napiszbutt")){
document.getElementById("id_body").style.fontSize = "1rem";
document.getElementById("id_subject").style.fontSize = "1rem";
document.getElementById("id_recipient").style.fontSize = "1rem";
document.getElementById("napisz").style.fontSize = "1rem";
document.getElementById("napiszbutt").style.fontSize = "1.7vw";
}

if (document.getElementById("tab")){
    document.getElementById("tab").className = "messages";

    var ostatnie = document.querySelectorAll("#last_td");
    ostatnie.forEach(function(kolumna) {
    kolumna.style.width= "21%";
    kolumna.style.textAlign = "left";
    });
}
//-------------
if (document.getElementById("m_info")){
document.getElementById("m_info").style.fontSize = "1rem";
document.getElementById("mesydz").style.fontSize = "1rem";
}
if (document.getElementById("o_u")){
document.getElementById("o_u").style.fontSize = "1rem";
}
//------------

}
}

function getCookie(cname) {
  var name = cname + "=";
  var decodedCookie = decodeURIComponent(document.cookie);
  var ca = decodedCookie.split(';');
  for(var i = 0; i <ca.length; i++) {
    var c = ca[i];
    while (c.charAt(0) == ' ') {
      c = c.substring(1);
    }
    if (c.indexOf(name) == 0) {
      return c.substring(name.length, c.length);
    }
  }
  return "";
}

function komu(evnt) {
document.getElementById("id_recipient").value = getCookie("pw_dla");
document.getElementById("id_subject").value = getCookie("pw_temat");
}

if (getCookie("pw_dla") != "") {
komu();
}

setInterval(function(){ updateilepw();}, 60000);
function updateilepw() {
document.getElementById('i0').contentWindow.location.reload();
}

window.addEventListener("message", uaktualnienie, false);

var ilewiadomosciwczesniej = parseInt("{% inbox_count %}")
function uaktualnienie(evnt) {
document.getElementById("b0").innerHTML = "Otrzymane(" + evnt.data + ")"
if (parseInt(evnt.data) != ilewiadomosciwczesniej && window.location.href == "https://cbrl.pythonanywhere.com/messages/inbox/") {
window.location.reload();
}
}

document.addEventListener("visibilitychange", handleVisibilityChange, false);

function handleVisibilityChange() {


if (document.hidden != true) {
location.reload();

}
};

var d = new Date();
var exdays = 1;
d.setTime(d.getTime() + (exdays*24*60*60*1000));
var expires = "expires="+ d.toUTCString();
document.cookie = "synchro_pw" + "=" + "{% inbox_count %}" + ";" + expires + ";path=/";

setInterval(function(){ synchro();}, 5000);

function synchro() {
document.getElementById("b0").innerHTML = "Otrzymane(" + getCookie("synchro_pw") + ")"

if (parseInt(getCookie("synchro_pw")) != ilewiadomosciwczesniej && window.location.href == "https://cbrl.pythonanywhere.com/messages/inbox/") {
window.location.reload();
}
}
</script>
